######################################################
### Template for SOM-CVODE codegen.               ###
### This is work in progress. Expect major changes.###
######################################################

###################################################################
/*
  C code automatically generated from a LEMS/SEM description
    compile with provided Makefile
*/
###################################################################
#macro (rollK $map)#foreach ($k in $map.keySet())$k, #end#end
##
#macro (rollV $map)#foreach ($k in $map.keySet())$map.get($k), #end#end
##
#macro (unpackNames $map $indent)#foreach ($k in $map.keySet())$indent$k = $map.get($k);
#end#end##
##
#macro (idx2names $name $map $indent)#foreach ($k in $map.keySet())#set($i = $velocityCount-1)$indent$k = ${name}[$i];
#end#end##
#macro (sign2num $s)#if ($s == "+")1#elseif($s == "-")-1#elseif($s == "0")0#else???#end#end##
#set ($idt1 = "    ")
#set ($idt2 = "$idt1$idt1")
#set ($idt3 = "$idt2$idt1")
#set ($idt4 = "$idt2$idt2")
###################################################################


#############################################################
#############################################################
static int f(realtype t, N_Vector state, N_Vector dstate,  void *p){
    
    realtype pars[$parameters.size()] = (realtype *) p;

#idx2names("state", $state, "${idt1}realtype ")

#idx2names("pars", $parameters, "${idt1}realtype ")

#unpackNames($state_functions, "${idt1}realtype ")

#foreach ($xi in $dynamics.keySet())##
#set($i = $velocityCount-1)##
    NV_Ith_S(dstate, $i) = $dynamics.get($xi);
#end

    return(0);
}
